<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>0.1 Data Types | 04b-Introduction_to_Bioconductor.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="0.1 Data Types | 04b-Introduction_to_Bioconductor.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="0.1 Data Types | 04b-Introduction_to_Bioconductor.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!-- for Facebook -->  
<meta property="og:url" content="http://hemberg-lab.github.io/scRNA.seq.course/" />
<meta property="og:description" content="In this course we will be surveying the existing problems as well as the available computational and statistical frameworks available for the analysis of scRNA-seq. The course is taught through the University of Cambridge Bioinformatics training unit, but the material found on these pages is meant to be used for anyone interested in learning about computational analysis of scRNA-seq data." />
<meta property="og:image" content="http://hemberg-lab.github.io/scRNA.seq.course/figures/RNA-Seq_workflow-5.pdf.jpg" />

<!-- for Twitter -->          
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Analysis of single-cell RNA-seq data" />
<meta name="twitter:description" content="In this course we will be surveying the existing problems as well as the available computational and statistical frameworks available for the analysis of scRNA-seq. The course is taught through the University of Cambridge Bioinformatics training unit, but the material found on these pages is meant to be used for anyone interested in learning about computational analysis of scRNA-seq data." />
<meta name="twitter:image" content="http://hemberg-lab.github.io/scRNA.seq.course/figures/RNA-Seq_workflow-5.pdf.jpg" />

<!-- Google Analytics -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-71525309-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-71525309-1');
</script>

<!-- For Logo -->
<script>
  $(document).ready(function(){
    $(".book-header").prepend('<img id="SangerLogo" src="figures/sanger-logo-header.png" />')
  }
</script>

<script>
  $(document).ready(function(){
    $('.book-header').wrap( $('<a>').attr('href', 'https://www.sanger.ac.uk/').attr('target', '_blank'))
  });
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Table of Contents</a></li>

<li class="divider"></li>
<li class="chapter" data-level="0.1" data-path=""><a href="#data-types"><i class="fa fa-check"></i><b>0.1</b> Data Types</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path=""><a href="#what-is-tidy-data"><i class="fa fa-check"></i><b>0.1.1</b> What is Tidy Data?</a></li>
<li class="chapter" data-level="0.1.2" data-path=""><a href="#what-is-rich-data"><i class="fa fa-check"></i><b>0.1.2</b> What is Rich Data?</a></li>
<li class="chapter" data-level="0.1.3" data-path=""><a href="#what-is-bioconductor"><i class="fa fa-check"></i><b>0.1.3</b> What is Bioconductor?</a></li>
<li class="chapter" data-level="0.1.4" data-path=""><a href="#singlecellexperiment-class"><i class="fa fa-check"></i><b>0.1.4</b> <code>SingleCellExperiment</code> class</a></li>
<li class="chapter" data-level="0.1.5" data-path=""><a href="#scater-package"><i class="fa fa-check"></i><b>0.1.5</b> <code>scater</code> package</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://www.sanger.ac.uk/science/groups/hemberg-group" target="blank">Hemberg Lab</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="data-types" class="section level2" number="0.1">
<h2><span class="header-section-number">0.1</span> Data Types</h2>
<div id="what-is-tidy-data" class="section level3" number="0.1.1">
<h3><span class="header-section-number">0.1.1</span> What is Tidy Data?</h3>
<p>Tidy data is a concept largely defined by Hadley Wickham <span class="citation">[@wickham_2014]</span>. Tidy data has the following three characteristics:</p>
<ol style="list-style-type: decimal">
<li>Each variable has its own column.</li>
<li>Each observation has its own row.</li>
<li>Each value has its own cell.</li>
</ol>
<p>Here is an example of some tidy data:</p>
<pre><code>##   Students   Subject Years Score
## 1     Mark     Maths     1     5
## 2     Jane   Biology     2     6
## 3 Mohammed   Physics     3     4
## 4      Tom     Maths     2     7
## 5    Celia Computing     3     9</code></pre>
<p>Here is an example of some untidy data:</p>
<pre><code>##    Students    Sport Category Counts
## 1      Matt   Tennis     Wins      0
## 2      Matt   Tennis   Losses      1
## 3     Ellie    Rugby     Wins      3
## 4     Ellie    Rugby   Losses      2
## 5       Tim Football     Wins      1
## 6       Tim Football   Losses      4
## 7    Louise Swimming     Wins      2
## 8    Louise Swimming   Losses      2
## 9     Kelly  Running     Wins      5
## 10    Kelly  Running   Losses      1</code></pre>
<p>Task 1: In what ways is the untidy data not tidy? How could we make the untidy data tidy?</p>
<p>Tidy data is generally easier to work with than untidy data, especially if you are working with packages such as ggplot. Fortunately, packages are available to make untidy data tidy. Today we will explore a few of the functions available in the tidyr package which can be used to make untidy data tidy. If you are interested in finding out more about tidying data, we recommend reading “R for Data Science”, by Garrett Grolemund and Hadley Wickham. An electronic copy is available here: <a href="http://r4ds.had.co.nz/" class="uri">http://r4ds.had.co.nz/</a></p>
<p>The untidy data above is untidy because two variables (<code>Wins</code> and <code>Losses</code>) are stored in one column (<code>Category</code>). This is a common way in which data can be untidy. To tidy this data, we need to make <code>Wins</code> and <code>Losses</code> into columns, and store the values in <code>Counts</code> in these columns. Fortunately, there is a function from the tidyverse packages to perform this operation. The function is called <code>spread</code>, and it takes two arguments, <code>key</code> and <code>value</code>. You should pass the name of the column which contains multiple variables to <code>key</code>, and pass the name of the column which contains values from multiple variables to <code>value</code>. For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## Warning in system(&quot;timedatectl&quot;, intern = TRUE): running command &#39;timedatectl&#39;
## had status 1</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sports<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Students=</span><span class="fu">c</span>(<span class="st">&quot;Matt&quot;</span>, <span class="st">&quot;Matt&quot;</span>, <span class="st">&quot;Ellie&quot;</span>, <span class="st">&quot;Ellie&quot;</span>, <span class="st">&quot;Tim&quot;</span>, <span class="st">&quot;Tim&quot;</span>, <span class="st">&quot;Louise&quot;</span>, <span class="st">&quot;Louise&quot;</span>, <span class="st">&quot;Kelly&quot;</span>, <span class="st">&quot;Kelly&quot;</span>), <span class="at">Sport=</span><span class="fu">c</span>(<span class="st">&quot;Tennis&quot;</span>,<span class="st">&quot;Tennis&quot;</span>, <span class="st">&quot;Rugby&quot;</span>, <span class="st">&quot;Rugby&quot;</span>,<span class="st">&quot;Football&quot;</span>, <span class="st">&quot;Football&quot;</span>,<span class="st">&quot;Swimming&quot;</span>,<span class="st">&quot;Swimming&quot;</span>, <span class="st">&quot;Running&quot;</span>, <span class="st">&quot;Running&quot;</span>), <span class="at">Category=</span><span class="fu">c</span>(<span class="st">&quot;Wins&quot;</span>, <span class="st">&quot;Losses&quot;</span>, <span class="st">&quot;Wins&quot;</span>, <span class="st">&quot;Losses&quot;</span>, <span class="st">&quot;Wins&quot;</span>, <span class="st">&quot;Losses&quot;</span>, <span class="st">&quot;Wins&quot;</span>, <span class="st">&quot;Losses&quot;</span>, <span class="st">&quot;Wins&quot;</span>, <span class="st">&quot;Losses&quot;</span>), <span class="at">Counts=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sports</span></code></pre></div>
<pre><code>##    Students    Sport Category Counts
## 1      Matt   Tennis     Wins      0
## 2      Matt   Tennis   Losses      1
## 3     Ellie    Rugby     Wins      3
## 4     Ellie    Rugby   Losses      2
## 5       Tim Football     Wins      1
## 6       Tim Football   Losses      4
## 7    Louise Swimming     Wins      2
## 8    Louise Swimming   Losses      2
## 9     Kelly  Running     Wins      5
## 10    Kelly  Running   Losses      1</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spread</span>(sports, <span class="at">key=</span>Category, <span class="at">value=</span>Counts)</span></code></pre></div>
<pre><code>##   Students    Sport Losses Wins
## 1    Ellie    Rugby      2    3
## 2    Kelly  Running      1    5
## 3   Louise Swimming      2    2
## 4     Matt   Tennis      1    0
## 5      Tim Football      4    1</code></pre>
<p>Task 2: The dataframe <code>foods</code> defined below is untidy. Work out why and use <code>spread()</code> to tidy it</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>foods<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">student=</span><span class="fu">c</span>(<span class="st">&quot;Antoinette&quot;</span>,<span class="st">&quot;Antoinette&quot;</span>,<span class="st">&quot;Taylor&quot;</span>, <span class="st">&quot;Taylor&quot;</span>, <span class="st">&quot;Alexa&quot;</span>, <span class="st">&quot;Alexa&quot;</span>), <span class="at">Category=</span><span class="fu">c</span>(<span class="st">&quot;Dinner&quot;</span>, <span class="st">&quot;Dessert&quot;</span>, <span class="st">&quot;Dinner&quot;</span>, <span class="st">&quot;Dessert&quot;</span>, <span class="st">&quot;Dinner&quot;</span>,<span class="st">&quot;Dessert&quot;</span>), <span class="at">Frequency=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>The other common way in which data can be untidy is if the columns are values instead of variables. For example, the dataframe below shows the percentages some students got in tests they did in May and June. The data is untidy because the columns <code>May</code> and <code>June</code> are values, not variables.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>percentages<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">student=</span><span class="fu">c</span>(<span class="st">&quot;Alejandro&quot;</span>, <span class="st">&quot;Pietro&quot;</span>, <span class="st">&quot;Jane&quot;</span>), <span class="st">&quot;May&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">90</span>,<span class="dv">12</span>,<span class="dv">45</span>), <span class="st">&quot;June&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">30</span>,<span class="dv">100</span>))</span></code></pre></div>
<p>Fortunately, there is a function in the tidyverse packages to deal with this problem too. <code>gather()</code> takes the names of the columns which are values, the <code>key</code> and the <code>value</code> as arguments. This time, the <code>key</code> is the name of the variable with values as column names, and the <code>value</code> is the name of the variable with values spread over multiple columns. Ie:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gather</span>(percentages, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="at">key=</span><span class="st">&quot;Month&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Percentage&quot;</span>)</span></code></pre></div>
<pre><code>##     student Month Percentage
## 1 Alejandro   May         90
## 2    Pietro   May         12
## 3      Jane   May         45
## 4 Alejandro  June         80
## 5    Pietro  June         30
## 6      Jane  June        100</code></pre>
<p>These examples don’t have much to do with single-cell RNA-seq analysis, but are designed to help illustrate the features of tidy and untidy data. You will find it much easier to analyse your single-cell RNA-seq data if your data is stored in a tidy format. Fortunately, the data structures we commonly use to facilitate single-cell RNA-seq analysis usually encourage store your data in a tidy manner.</p>
</div>
<div id="what-is-rich-data" class="section level3" number="0.1.2">
<h3><span class="header-section-number">0.1.2</span> What is Rich Data?</h3>
<p>If you google ‘rich data’, you will find lots of different definitions for this term. In this course, we will use ‘rich data’ to mean data which is generated by combining information from multiple sources. For example, you could make rich data by creating an object in R which contains a matrix of gene expression values across the cells in your single-cell RNA-seq experiment, but also information about how the experiment was performed. Objects of the <code>SingleCellExperiment</code> class, which we will discuss below, are an example of rich data.</p>
</div>
<div id="what-is-bioconductor" class="section level3" number="0.1.3">
<h3><span class="header-section-number">0.1.3</span> What is Bioconductor?</h3>
<p>From <a href="https://en.wikipedia.org/wiki/Bioconductor">Wikipedia</a>:
<a href="https://www.bioconductor.org/">Bioconductor</a> is a free, open source and open development software project for the analysis and comprehension of genomic data generated by wet lab experiments in molecular biology. Bioconductor is based primarily on the statistical R programming language, but does contain contributions in other programming languages. It has two releases each year that follow the semiannual releases of R. At any one time there is a release version, which corresponds to the released version of R, and a development version, which corresponds to the development version of R. Most users will find the release version appropriate for their needs.</p>
<p>We strongly recommend all new comers and even experienced high-throughput data analysts to use well developed and maintained <a href="https://www.bioconductor.org/developers/how-to/commonMethodsAndClasses/">Bioconductor methods and classes</a>.</p>
</div>
<div id="singlecellexperiment-class" class="section level3" number="0.1.4">
<h3><span class="header-section-number">0.1.4</span> <code>SingleCellExperiment</code> class</h3>
<p><a href="http://bioconductor.org/packages/SingleCellExperiment"><code>SingleCellExperiment</code></a> (SCE) is a S4 class for storing data from single-cell experiments. This includes specialized methods to store and retrieve spike-in information, dimensionality reduction coordinates and size factors for each cell, along with the usual metadata for genes and libraries.</p>
<p>In practice, an object of this class can be created using its constructor:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SingleCellExperiment)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rpois</span>(<span class="dv">100</span>, <span class="at">lambda =</span> <span class="dv">10</span>), <span class="at">ncol=</span><span class="dv">10</span>, <span class="at">nrow=</span><span class="dv">10</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;gene&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;cell&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">SingleCellExperiment</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">assays =</span> <span class="fu">list</span>(<span class="at">counts =</span> counts),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rowData =</span> <span class="fu">data.frame</span>(<span class="at">gene_names =</span> <span class="fu">paste</span>(<span class="st">&quot;gene_name&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">data.frame</span>(<span class="at">cell_names =</span> <span class="fu">paste</span>(<span class="st">&quot;cell_name&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>sce</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 10 10 
## metadata(0):
## assays(1): counts
## rownames(10): gene1 gene2 ... gene9 gene10
## rowData names(1): gene_names
## colnames(10): cell1 cell2 ... cell9 cell10
## colData names(1): cell_names
## reducedDimNames(0):
## altExpNames(0):</code></pre>
<p>In the <code>SingleCellExperiment</code>, users can assign arbitrary names to entries of assays. To assist interoperability between packages, some suggestions for what the names should be for particular types of data are provided by the authors:</p>
<ul>
<li><strong>counts</strong>: Raw count data, e.g., number of reads or transcripts for a particular gene.</li>
<li><strong>normcounts</strong>: Normalized values on the same scale as the original counts. For example, counts divided by cell-specific size factors that are centred at unity.</li>
<li><strong>logcounts</strong>: Log-transformed counts or count-like values. In most cases, this will be defined as log-transformed normcounts, e.g., using log base 2 and a pseudo-count of 1.</li>
<li><strong>cpm</strong>: Counts-per-million. This is the read count for each gene in each cell, divided by the library size of each cell in millions.</li>
<li><strong>tpm</strong>: Transcripts-per-million. This is the number of transcripts for each gene in each cell, divided by the total number of transcripts in that cell (in millions).</li>
</ul>
<p>Each of these suggested names has an appropriate getter/setter method for convenient manipulation of the <code>SingleCellExperiment</code>. For example, we can take the (very specifically named) <code>counts</code> slot, normalise it and assign it to <code>normcounts</code> instead:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">normcounts</span>(sce) <span class="ot">&lt;-</span> <span class="fu">log2</span>(<span class="fu">counts</span>(sce) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sce</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 10 10 
## metadata(0):
## assays(2): counts normcounts
## rownames(10): gene1 gene2 ... gene9 gene10
## rowData names(1): gene_names
## colnames(10): cell1 cell2 ... cell9 cell10
## colData names(1): cell_names
## reducedDimNames(0):
## altExpNames(0):</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">normcounts</span>(sce))</span></code></pre></div>
<pre><code>## [1] 10 10</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">normcounts</span>(sce))</span></code></pre></div>
<pre><code>##          cell1    cell2    cell3    cell4    cell5    cell6    cell7    cell8
## gene1 3.169925 3.169925 2.000000 2.584963 2.584963 3.321928 3.584963 3.321928
## gene2 3.459432 1.584963 3.584963 3.807355 3.700440 3.700440 3.000000 3.807355
## gene3 3.000000 3.169925 3.807355 3.169925 3.321928 3.321928 3.321928 2.584963
## gene4 3.584963 3.459432 3.000000 3.807355 3.700440 3.700440 3.700440 3.169925
## gene5 3.906891 3.000000 3.169925 3.321928 3.584963 3.459432 3.807355 3.807355
## gene6 3.700440 3.700440 3.584963 4.000000 3.169925 3.000000 3.459432 3.321928
##          cell9   cell10
## gene1 3.807355 2.807355
## gene2 3.700440 4.000000
## gene3 4.000000 3.700440
## gene4 3.584963 3.700440
## gene5 2.584963 3.584963
## gene6 3.459432 4.000000</code></pre>
</div>
<div id="scater-package" class="section level3" number="0.1.5">
<h3><span class="header-section-number">0.1.5</span> <code>scater</code> package</h3>
<p><a href="http://bioconductor.org/packages/scater/"><code>scater</code></a> is a R package for single-cell RNA-seq analysis <span class="citation">[@McCarthy2017-kb]</span>. The package contains several useful methods for quality control, visualisation and pre-processing of data prior to further downstream analysis.</p>
<p><code>scater</code> features the following functionality:</p>
<ul>
<li>Automated computation of QC metrics</li>
<li>Transcript quantification from read data with pseudo-alignment</li>
<li>Data format standardisation</li>
<li>Rich visualizations for exploratory analysis</li>
<li>Seamless integration into the Bioconductor universe</li>
<li>Simple normalisation methods</li>
</ul>
<p>We highly recommend to use <code>scater</code> for all single-cell RNA-seq analyses and <code>scater</code> is the basis of the first part of the course.</p>
<p>As illustrated in the figure below, <code>scater</code> will help you with quality control, filtering and normalization of your expression matrix following mapping and alignment. <span style="color:red">Keep in mind that this figure represents the original version of <code>scater</code> where an <code>SCESet</code> class was used. In the newest version this figure is still correct, except that <code>SCESet</code> can be substituted with the <code>SingleCellExperiment</code> class.</span></p>
<p><img src="figures/scater_qc_workflow.png" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"search": false
});
});
</script>

</body>

</html>
